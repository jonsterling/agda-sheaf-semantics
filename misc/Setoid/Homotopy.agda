module Setoid.Homotopy where

open import Agda.Primitive
import Setoid.Base as S
import Setoid.Path as Path
import Setoid.Product.Boot as ╬а
import Setoid.Terminal as ­ЮЪЎ
import Type as T

record _РЄњРѓЂ_ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░}
  {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  (F G : A ╬а.РЄњРѓђрхЌ B)
    : Set (РёЊРѓђрхњ Ріћ РёЊРѓЂ╩░) where
  constructor nat
  field
    com : Рѕђ {a} Рєњ S.t.hom B (F ╬а.$Рѓђ a T.Рѕљ., G ╬а.$Рѓђ a)
open _РЄњРѓЂ_ public

idn
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ (F : A ╬а.РЄњРѓђрхЌ B)
  Рєњ T.­ЮЪЎ.t T.╬а.РЄњРѓђ (F РЄњРѓЂ F)
idn {A = A} F = ╬╗ x Рєњ nat (F ╬а.$РѓЂ S.t.idn A x)

cmp
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G H : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (G РЄњРѓЂ H) T.Рѕљ.├Ќ (F РЄњРѓЂ G)
  Рєњ F РЄњРѓЂ H
cmp {B = B} (╬▓ T.Рѕљ., ╬▒) = record
  { com = S.cmp B (com ╬▓ T.Рѕљ., com ╬▒) }

inv
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (F РЄњРѓЂ G) T.╬а.РЄњРѓђ (G РЄњРѓЂ F)
inv {B = B} ╬▒ = record
  { com = S.inv B (com ╬▒) }

cmp-wРѓђ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░ }
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ (H╬▒ : (B ╬а.РЄњРѓђрхЌ C) T.Рѕљ.├Ќ (F РЄњРѓЂ G))
  Рєњ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌ F) РЄњРѓЂ (T.Рѕљ.¤ђРѓђ H╬▒ ╬а.РѕўрхЌ G)
cmp-wРѓђ (H T.Рѕљ., ╬▒) = record
  { com = H ╬а.$РѓЂ com ╬▒ }

cmp-wРѓЂ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
   Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {G H : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓F : (G РЄњРѓЂ H) T.Рѕљ.├Ќ (A ╬а.РЄњРѓђрхЌ B))
  Рєњ (G ╬а.РѕўрхЌ T.Рѕљ.¤ђРѓЂ ╬▓F) РЄњРѓЂ (H ╬а.РѕўрхЌ T.Рѕљ.¤ђРѓЂ ╬▓F)
cmp-wРѓЂ (╬▓ T.Рѕљ., F) = record
  { com = com ╬▓ }

cmp-hРѓђ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.├Ќ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌ F) РЄњРѓЂ (K ╬а.РѕўрхЌ G)
cmp-hРѓђ {C = C} {K = K} (╬▓ T.Рѕљ., ╬▒) = record
  { com = S.cmp C (K ╬а.$РѓЂ com ╬▒ T.Рѕљ., com ╬▓) }

cmp-hРѓЂ
  : Рѕђ ..{РёЊРѓђрхњ РёЊРѓђ╩░ РёЊРѓЂрхњ РёЊРѓЂ╩░ РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {A : S.t РёЊРѓђрхњ РёЊРѓђ╩░} {B : S.t РёЊРѓЂрхњ РёЊРѓЂ╩░} {C : S.t РёЊРѓѓрхњ РёЊРѓѓ╩░}
  Рєњ {F G : A ╬а.РЄњРѓђрхЌ B}
  Рєњ {H K : B ╬а.РЄњРѓђрхЌ C}
  Рєњ (╬▓╬▒ : (H РЄњРѓЂ K) T.Рѕљ.├Ќ (F РЄњРѓЂ G))
  Рєњ (H ╬а.РѕўрхЌ F) РЄњРѓЂ (K ╬а.РѕўрхЌ G)
cmp-hРѓЂ {C = C} {H = H} (╬▓ T.Рѕљ., ╬▒) = record
  { com = S.cmp C (com ╬▓ T.Рѕљ., H ╬а.$РѓЂ com ╬▒) }
